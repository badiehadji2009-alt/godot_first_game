extends CanvasLayer # ูุฌุจ ุฃู ุชููู ุงูุนูุฏุฉ ุงูุฌุฐุฑูุฉ ูู CanvasLayer

# --- ุฅุดุงุฑุงุช (Signals) ---
# ูุฐู ุงูุฅุดุงุฑุฉ ูุชู ุงุณุชูุจุงููุง ูู ููุฏ ุงููุงุนุจ (Player.gd) ูุฅูุบุงุก ุงูุฅููุงู ุงููุคูุช ูุชุบููุฑ ุงููุดูุฏ.
signal restart_game

# --- ุฑุจุท ุงูุนูุฏ ---
# ๐ก ุชุฃูุฏ ูู ุฃู ุงุณู ุงูุนูุฏุฉ ูู "GameOverSoundPlayer" ูู ุงููุดูุฏ.
@onready var game_over_sound_player = $GameOverSound 
# ๐ก ุงูุชุฑุถ ุฃู ุฒุฑ ุฅุนุงุฏุฉ ุงูุชุดุบูู (RestartButton) ููุฌูุฏ ูุจุงุดุฑุฉ ูุงุจู ูููุญุฉ (ุฃู ุงูุนูุฏุฉ ุงูุฌุฐุฑูุฉ ุญุณุจ ุชุตูููู)
@onready var restart_button: Button = $Button
# ุฅุฐุง ูุงู ุงูุฒุฑ ุฏุงุฎู ููุญุฉ: @onready var restart_button: Button = $Panel/RestartButton


# ----------------------------------------------------
## ๐ _ready - ุชุฌููุฒ ุงูุดุงุดุฉ ูุชุดุบูู ุงูุตูุช
# ----------------------------------------------------

func _ready() -> void:
	# ๐ ุชุดุบูู ุตูุช Game Over ููุฑ ุธููุฑ ุงูุดุงุดุฉ
	if game_over_sound_player:
		game_over_sound_player.play()
	
	# ๐ก ุฑุจุท ุฒุฑ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุจุงูุฏุงูุฉ
	if restart_button:
		# ุชุฃูุฏ ูู ุฃู ุฒุฑ ุฅุนุงุฏุฉ ุงูุชุดุบูู ูุฏูู Process Mode ูุถุจูุท ุนูู Always ูุชุฌุงูู ุงูุชููู ุงููุคูุช
		restart_button.process_mode = Node.PROCESS_MODE_ALWAYS
		restart_button.pressed.connect(_on_restart_button_pressed)


# ----------------------------------------------------
## โฏ๏ธ ุฏูุงู ุงูุชุญูู
# ----------------------------------------------------

func _on_restart_button_pressed() -> void:
	# 1. ุฅุฑุณุงู ุงูุฅุดุงุฑุฉ ุฅูู ุงููุงุนุจ/ูุฏูุฑ ุงููุนุจุฉ
	emit_signal("restart_game")
	
	# 2. ุฅููุงู ุตูุช Game Over (ุงุฎุชูุงุฑูุ ูููุน ุงุณุชูุฑุงุฑู ุจุนุฏ ุงูุนูุฏุฉ ููุนุจุฉ)
	if game_over_sound_player:
		game_over_sound_player.stop()

	# (ููุงุญุธุฉ: ุงููุงุนุจ ูู ุงููุณุคูู ุนู ุฅูุบุงุก ุงูุฅููุงู ุงููุคูุช ูุญุฐู ุนูุฏุฉ GameOver)
